(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8928:function(e,t,n){Promise.resolve().then(n.bind(n,1598))},1598:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var a=n(7437),i=n(2265),s=n(971),r=n(6391),c=n(1398);n(7300),s.Tu.workerSrc="//unpkg.com/pdfjs-dist@".concat(s.i8,"/build/pdf.worker.min.mjs");let l=e=>{let{setModalOpen:t,setSignature:n}=e,s=(0,i.useRef)(null),r=(0,i.useRef)(null),[l,o]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=s.current,t=e.getContext("2d");e.width=e.offsetWidth,e.height=e.offsetHeight,t.lineWidth=3,t.lineCap="round",t.lineJoin="round",r.current=new c.x({radius:10,enabled:!0,initialPoint:{x:e.width/2,y:e.height/2}})},[]);let d=e=>{if(!l)return;let t=s.current,n=t.getContext("2d"),a=t.getBoundingClientRect(),i=e.clientX-a.left,c=e.clientY-a.top;r.current.update({x:i,y:c});let o=r.current.getBrushCoordinates();n.lineTo(o.x,o.y),n.stroke(),n.beginPath(),n.moveTo(o.x,o.y)},h=()=>{o(!1),s.current.getContext("2d").beginPath()};return(0,a.jsx)("div",{className:"sign-modal",children:(0,a.jsxs)("div",{className:"window",children:[(0,a.jsx)("div",{className:"title",children:"Add Your Signature"}),(0,a.jsxs)("div",{className:"content",children:[(0,a.jsx)("canvas",{ref:s,width:400,height:200,onMouseDown:e=>{o(!0),d(e)},onMouseMove:d,onMouseUp:h,onMouseLeave:h}),(0,a.jsxs)("div",{className:"overlay",children:[(0,a.jsx)("div",{className:"line"}),(0,a.jsx)("span",{children:"Draw your signature here"})]})]}),(0,a.jsxs)("div",{className:"actions",children:[(0,a.jsx)("button",{onClick:()=>t(!1),children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{n(s.current.toDataURL("image/png")),t(!1)},children:"Add Signature"})]})]})})};var o=e=>{let{pdfUrl:t,scale:n,save:c,setSave:o}=e,d=(0,i.useRef)(null),[h,u]=(0,i.useState)(null),[g,m]=(0,i.useState)([]),[x,p]=(0,i.useState)({}),[f,v]=(0,i.useState)(0),[w,j]=(0,i.useState)(!1),[y,N]=(0,i.useState)(null),[S,b]=(0,i.useState)(null),C="http://www.w3.org/2000/svg";(0,i.useEffect)(()=>{s.Me(t).promise.then(e=>{u(e)})},[t]),(0,i.useEffect)(()=>{h&&(async()=>{d.current.innerHTML="";for(let e=1;e<=h.numPages;e++){let t=document.createElement("div");t.className="page-container page-".concat(e),d.current.appendChild(t);let a=await h.getPage(e),i=a.getViewport({scale:n}),s=document.createElement("canvas"),r=s.getContext("2d"),c=2*window.devicePixelRatio;s.id="canvas-page-".concat(e),s.width=Math.floor(i.width*c),s.height=Math.floor(i.height*c),s.style.width="".concat(Math.floor(i.width),"px"),s.style.height="".concat(Math.floor(i.height),"px"),t.appendChild(s),r.scale(c,c);let l={canvasContext:r,viewport:i,renderInteractiveForms:!1,textLayer:{beginLayout:()=>{},endLayout:()=>{},appendText:()=>{}}};await a.render(l);let o=E(i,await a.getTextContent()),u=document.createElement("div");if(u.className="vector-container",u.style.position="absolute",u.style.top="0",u.style.left="0",u.appendChild(o),t.appendChild(u),m(e=>[...e,s]),1===e){let a=document.createElement("div");a.className="signature-box",a.style.width="".concat((150*n).toFixed(0),"px"),a.style.height="".concat((75*n).toFixed(0),"px"),a.style.top="".concat((650*n).toFixed(0),"px"),a.style.left="".concat((380*n).toFixed(0),"px"),a.onclick=t=>{if(document.querySelector("#signature")){let n=t.target.offsetLeft,a=t.target.offsetTop,i=(n/t.target.parentElement.querySelector(".vector-container").clientWidth).toFixed(3),s=(a/t.target.parentElement.querySelector(".vector-container").clientHeight).toFixed(3);t.target.style.opacity="0.5",t.target.style.background="transparent",t.target.style.pointerEvents="none",b({xPercent:i,yPercent:s,pageNum:e})}},t.appendChild(a)}}})()},[h,n]),(0,i.useEffect)(()=>{g.forEach(e=>{x[e.id]||p(t=>({...t,[e.id]:k(e,.25)}))})},[g]),(0,i.useEffect)(()=>{if(S&&y){let e=document.getElementById("canvas-page-".concat(S.pageNum)),t=e.getContext("2d"),a=new Image;a.onload=()=>{t.drawImage(a,S.xPercent*e.clientWidth,S.yPercent*e.clientHeight,(150*n).toFixed(0),(75*n).toFixed(0))},a.src=y}},[S,y]),(0,i.useEffect)(()=>{c&&(P(),o(!1))},[c]);let E=(e,t)=>{let n=document.createElementNS(C,"svg");return n.setAttribute("width",e.width+"px"),n.setAttribute("height",e.height+"px"),n.setAttribute("font-size",1),t.items.forEach(a=>{let i=s.Zr.transform(s.Zr.transform(e.transform,a.transform),[1,0,0,-1,0,0]),r=t.styles[a.fontName],c=document.createElementNS(C,"text");c.setAttribute("transform","matrix("+i.join(" ")+")"),c.setAttribute("font-family",r.fontFamily),c.textContent=a.str,n.appendChild(c)}),n},k=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,a=document.createElement("canvas");return a.width=e.width*t,a.height=e.height*t,a.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,e.width*t,e.height*t),a.toDataURL("image/jpeg",n)},P=async()=>{if(y&&S)try{let e=await fetch(t).then(e=>e.arrayBuffer()),n=await r.PDFDocument.load(e),a=document.createElement("canvas"),i=a.getContext("2d"),s=new Image;s.src=y,await new Promise(e=>s.onload=e),a.width=s.width,a.height=s.height,i.drawImage(s,0,0,s.width,s.height);let c=n.getPage(S.pageNum-1),{width:l,height:o}=c.getSize(),d=document.getElementById("canvas-page-".concat(S.pageNum)),h=l/d.clientWidth,u=l*S.xPercent*h,g=(o-o*S.yPercent-75)*h;c.drawImage(await n.embedPng(a.toDataURL()),{x:u,y:g,width:150*h,height:75*h});let m=await n.save(),x=new Blob([m],{type:"application/pdf"}),p=document.createElement("a");p.href=URL.createObjectURL(x),p.download="Bill-of-Sale_Signed.pdf",p.click()}catch(e){console.error("Error al guardar el PDF:",e)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"pdf-viewer",children:[(0,a.jsx)("div",{className:"page-selector",children:Object.keys(x).length>0&&Object.keys(x).map((e,t)=>(0,a.jsxs)("div",{className:"thumbnail ".concat(e," ").concat(f==t?"selected":""),onClick:()=>{v(t),document.querySelector("#".concat(e)).scrollIntoView({behavior:"smooth"})},children:[(0,a.jsx)("img",{src:x[e]}),(0,a.jsx)("div",{className:"th-info",children:(0,a.jsx)("span",{children:t})})]},e))}),(0,a.jsx)("div",{className:"pdf-file",ref:d}),(0,a.jsxs)("div",{className:"sign-tools",children:[(0,a.jsx)("span",{children:"Signature"}),(0,a.jsxs)("div",{className:"box",children:[!y&&(0,a.jsx)("button",{onClick:()=>j(!0),children:(0,a.jsx)("span",{children:"+"})}),y?(0,a.jsx)("img",{src:y,id:"signature"}):(0,a.jsx)("span",{children:"Add Signature"})]})]})]}),w&&(0,a.jsx)(l,{setModalOpen:j,setSignature:N})]})},d=()=>(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:800,height:800,viewBox:"0 0 407.096 407.096",children:[(0,a.jsx)("path",{d:"M402.115 84.008 323.088 4.981A17.005 17.005 0 0 0 311.063 0H17.005C7.613 0 0 7.614 0 17.005v373.086c0 9.392 7.613 17.005 17.005 17.005h373.086c9.392 0 17.005-7.613 17.005-17.005V96.032c0-4.509-1.791-8.835-4.981-12.024zm-101.451 79.559H67.129V38.862h233.535v124.705z"}),(0,a.jsx)("path",{d:"M214.051 148.16h43.08a5.668 5.668 0 0 0 5.668-5.669V59.584a5.668 5.668 0 0 0-5.668-5.668h-43.08a5.668 5.668 0 0 0-5.668 5.668v82.907a5.668 5.668 0 0 0 5.668 5.669z"})]});n(2131);var h=()=>{let[e,t]=(0,i.useState)(1),[n,s]=(0,i.useState)(!1),r=()=>{t(e=>Math.min(e+.25,2))},c=()=>{t(e=>Math.max(e-.25,.5))};return(0,a.jsxs)("div",{className:"app",children:[(0,a.jsxs)("header",{className:"header",children:[(0,a.jsxs)("div",{className:"logo",children:[(0,a.jsx)("span",{children:"-"}),(0,a.jsx)("span",{children:"-"})]}),(0,a.jsxs)("h1",{children:[(0,a.jsx)("b",{children:"PDF"}),"Sign"]}),(0,a.jsx)("div",{className:"user",children:"Hello iserrano@..."})]}),(0,a.jsxs)("main",{className:"main-container",children:[(0,a.jsxs)("div",{className:"toolbar",children:[(0,a.jsx)("span",{className:"filename",children:"Bill-of-Sale.pdf"}),(0,a.jsxs)("div",{className:"zoom",children:[(0,a.jsx)("div",{onClick:()=>c(),children:"-"}),(0,a.jsx)("span",{children:"".concat((100*e).toFixed(0),"%")}),(0,a.jsx)("div",{onClick:()=>r(),children:"+"})]}),(0,a.jsx)("div",{className:"actions",children:(0,a.jsxs)("button",{onClick:()=>s(!0),children:[(0,a.jsx)(d,{}),"Save"]})})]}),(0,a.jsx)(o,{pdfUrl:"Bill-of-Sale.pdf",scale:e,save:n,setSave:s})]})]})}},7300:function(){},2131:function(){}},function(e){e.O(0,[408,980,996,971,23,744],function(){return e(e.s=8928)}),_N_E=e.O()}]);