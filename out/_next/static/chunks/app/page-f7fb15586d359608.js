(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8928:function(e,t,n){Promise.resolve().then(n.bind(n,1598))},1598:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var a=n(7437),i=n(2265),s=n(971),c=n(6391),l=n(1398);n(7300),s.Tu.workerSrc="//unpkg.com/pdfjs-dist@".concat(s.i8,"/build/pdf.worker.min.mjs");let r=e=>{let{setModalOpen:t,setSignature:n}=e,s=(0,i.useRef)(null),c=(0,i.useRef)(null),[r,o]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=s.current,t=e.getContext("2d");e.width=e.offsetWidth,e.height=e.offsetHeight,t.lineWidth=3,t.lineCap="round",t.lineJoin="round",c.current=new l.x({radius:10,enabled:!0,initialPoint:{x:e.width/2,y:e.height/2}})},[]);let d=e=>{if(!r)return;let t=s.current,n=t.getContext("2d"),a=t.getBoundingClientRect(),i=e.clientX-a.left,l=e.clientY-a.top;c.current.update({x:i,y:l});let o=c.current.getBrushCoordinates();n.lineTo(o.x,o.y),n.stroke(),n.beginPath(),n.moveTo(o.x,o.y)},h=()=>{o(!1),s.current.getContext("2d").beginPath()};return(0,a.jsx)("div",{className:"sign-modal",children:(0,a.jsxs)("div",{className:"window",children:[(0,a.jsx)("div",{className:"title",children:"Add Your Signature"}),(0,a.jsxs)("div",{className:"content",children:[(0,a.jsx)("canvas",{ref:s,width:400,height:200,onMouseDown:e=>{o(!0),d(e)},onMouseMove:d,onMouseUp:h,onMouseLeave:h}),(0,a.jsxs)("div",{className:"overlay",children:[(0,a.jsx)("div",{className:"line"}),(0,a.jsx)("span",{children:"Draw your signature here"})]})]}),(0,a.jsxs)("div",{className:"actions",children:[(0,a.jsx)("button",{onClick:()=>t(!1),children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{n(s.current.toDataURL("image/png")),t(!1)},children:"Add Signature"})]})]})})};var o=e=>{let{pdfUrl:t,signBoxes:n,scale:l,save:o,setSave:d}=e,h=(0,i.useRef)(null),[u,g]=(0,i.useState)(null),[x,m]=(0,i.useState)([]),[p,f]=(0,i.useState)({}),[v,w]=(0,i.useState)(0),[j,y]=(0,i.useState)(!1),[b,N]=(0,i.useState)(null),[C,S]=(0,i.useState)({}),E="http://www.w3.org/2000/svg";(0,i.useEffect)(()=>{s.Me(t).promise.then(e=>{g(e)})},[t]),(0,i.useEffect)(()=>{u&&(async()=>{h.current.innerHTML="";for(let e=1;e<=u.numPages;e++){let t=document.createElement("div");t.className="page-container page-".concat(e),h.current.appendChild(t);let a=await u.getPage(e),i=a.getViewport({scale:l}),s=document.createElement("canvas"),c=s.getContext("2d"),r=2*window.devicePixelRatio;s.id="canvas-page-".concat(e),s.width=Math.floor(i.width*r),s.height=Math.floor(i.height*r),s.style.width="".concat(Math.floor(i.width),"px"),s.style.height="".concat(Math.floor(i.height),"px"),t.appendChild(s),c.scale(r,r);let o={canvasContext:c,viewport:i,renderInteractiveForms:!1,textLayer:{beginLayout:()=>{},endLayout:()=>{},appendText:()=>{}}};await a.render(o);let d=M(i,await a.getTextContent()),g=document.createElement("div");g.className="vector-container",g.style.position="absolute",g.style.top="0",g.style.left="0",g.appendChild(d),t.appendChild(g),m(e=>[...e,s]),n&&n.forEach((n,a)=>{if(e===n.page){let e=document.createElement("div");e.className="signature-box",e.style.width="".concat((150*l).toFixed(0),"px"),e.style.height="".concat((75*l).toFixed(0),"px"),e.style.left="".concat((s.clientWidth*n.x*l).toFixed(0),"px"),e.style.top="".concat((s.clientHeight*n.y*l).toFixed(0),"px"),e.onclick=e=>{document.querySelector("#signature")&&(n.x,n.y,e.target.style.opacity="0.5",e.target.style.background="transparent",e.target.style.pointerEvents="none",k(a))},t.appendChild(e)}})}})()},[u,l]),(0,i.useEffect)(()=>{x.forEach(e=>{p[e.id]||f(t=>({...t,[e.id]:F(e,.25)}))})},[x]),(0,i.useEffect)(()=>{Object.keys(C).forEach(e=>{let t=document.getElementById("canvas-page-".concat(n[e].page)),a=t.getContext("2d"),i=new Image;i.onload=()=>{a.drawImage(i,n[e].x*t.clientWidth,n[e].y*t.clientHeight,(150*l).toFixed(0),(75*l).toFixed(0))},i.src=b})},[C]),(0,i.useEffect)(()=>{o&&(P(),d(!1))},[o]);let k=e=>{S(t=>({...t,[e]:!0}))},M=(e,t)=>{let n=document.createElementNS(E,"svg");return n.setAttribute("width",e.width+"px"),n.setAttribute("height",e.height+"px"),n.setAttribute("font-size",1),t.items.forEach(a=>{let i=s.Zr.transform(s.Zr.transform(e.transform,a.transform),[1,0,0,-1,0,0]),c=t.styles[a.fontName],l=document.createElementNS(E,"text");l.setAttribute("transform","matrix("+i.join(" ")+")"),l.setAttribute("font-family",c.fontFamily),l.textContent=a.str,n.appendChild(l)}),n},F=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,a=document.createElement("canvas");return a.width=e.width*t,a.height=e.height*t,a.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,e.width*t,e.height*t),a.toDataURL("image/jpeg",n)},P=async()=>{if(b&&Object.keys(C).length)try{let e=await fetch(t).then(e=>e.arrayBuffer()),a=await c.PDFDocument.load(e),i=document.createElement("canvas"),s=i.getContext("2d"),l=new Image;l.src=b,await new Promise(e=>l.onload=e),i.width=l.width,i.height=l.height,s.drawImage(l,0,0,l.width,l.height),Object.keys(C).forEach(async e=>{let t=a.getPage(n[e].page-1),{width:s,height:c}=t.getSize(),l=document.getElementById("canvas-page-".concat(n[e].page)),r=s/l.clientWidth,o=s*n[e].x*r,d=(c-c*n[e].y-75)*r,h=await a.embedPng(i.toDataURL());t.drawImage(h,{x:o,y:d,width:150*r,height:75*r})});let r=await a.save(),o=new Blob([r],{type:"application/pdf"}),d=document.createElement("a");d.href=URL.createObjectURL(o),d.download="Bill-of-Sale_Signed.pdf",d.click()}catch(e){console.error("Error al guardar el PDF:",e)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"pdf-viewer",children:[(0,a.jsx)("div",{className:"page-selector",children:Object.keys(p).length>0&&Object.keys(p).map((e,t)=>(0,a.jsxs)("div",{className:"thumbnail ".concat(e," ").concat(v==t?"selected":""),onClick:()=>{w(t),document.querySelector("#".concat(e)).scrollIntoView({behavior:"smooth"})},children:[(0,a.jsx)("img",{src:p[e]}),(0,a.jsx)("div",{className:"th-info",children:(0,a.jsx)("span",{children:t})})]},e))}),(0,a.jsx)("div",{className:"pdf-file",ref:h}),(0,a.jsxs)("div",{className:"sign-tools",children:[(0,a.jsx)("span",{children:"Signature"}),(0,a.jsxs)("div",{className:"box",children:[!b&&(0,a.jsx)("button",{onClick:()=>y(!0),children:(0,a.jsx)("span",{children:"+"})}),b?(0,a.jsx)("img",{src:b,id:"signature"}):(0,a.jsx)("span",{children:"Add Signature"})]})]})]}),j&&(0,a.jsx)(r,{setModalOpen:y,setSignature:N})]})},d=()=>(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:800,height:800,viewBox:"0 0 407.096 407.096",children:[(0,a.jsx)("path",{d:"M402.115 84.008 323.088 4.981A17.005 17.005 0 0 0 311.063 0H17.005C7.613 0 0 7.614 0 17.005v373.086c0 9.392 7.613 17.005 17.005 17.005h373.086c9.392 0 17.005-7.613 17.005-17.005V96.032c0-4.509-1.791-8.835-4.981-12.024zm-101.451 79.559H67.129V38.862h233.535v124.705z"}),(0,a.jsx)("path",{d:"M214.051 148.16h43.08a5.668 5.668 0 0 0 5.668-5.669V59.584a5.668 5.668 0 0 0-5.668-5.668h-43.08a5.668 5.668 0 0 0-5.668 5.668v82.907a5.668 5.668 0 0 0 5.668 5.669z"})]});n(2131);var h=()=>{let[e,t]=(0,i.useState)(1),[n,s]=(0,i.useState)(!1),c=()=>{t(e=>Math.min(e+.25,2))},l=()=>{t(e=>Math.max(e-.25,.5))};return(0,a.jsxs)("div",{className:"app",children:[(0,a.jsxs)("header",{className:"header",children:[(0,a.jsxs)("div",{className:"logo",children:[(0,a.jsx)("span",{children:"-"}),(0,a.jsx)("span",{children:"-"})]}),(0,a.jsxs)("h1",{children:[(0,a.jsx)("b",{children:"PDF"}),"Sign"]}),(0,a.jsx)("div",{className:"user",children:"Hello iserrano@..."})]}),(0,a.jsxs)("main",{className:"main-container",children:[(0,a.jsxs)("div",{className:"toolbar",children:[(0,a.jsx)("span",{className:"filename",children:"Bill-of-Sale.pdf"}),(0,a.jsxs)("div",{className:"zoom",children:[(0,a.jsx)("div",{onClick:()=>l(),children:"-"}),(0,a.jsx)("span",{children:"".concat((100*e).toFixed(0),"%")}),(0,a.jsx)("div",{onClick:()=>c(),children:"+"})]}),(0,a.jsx)("div",{className:"actions",children:(0,a.jsxs)("button",{onClick:()=>s(!0),children:[(0,a.jsx)(d,{}),"Save"]})})]}),(0,a.jsx)(o,{pdfUrl:"Bill-of-Sale.pdf",signBoxes:[{page:1,x:.621,y:.821},{page:2,x:.286,y:.669},{page:3,x:.114,y:.631}],scale:e,save:n,setSave:s})]})]})}},7300:function(){},2131:function(){}},function(e){e.O(0,[408,980,996,971,23,744],function(){return e(e.s=8928)}),_N_E=e.O()}]);